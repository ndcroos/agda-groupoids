{-# OPTIONS --without-K #-}

module Groupoids.Ordinary.Universe where

open import Groupoids.Common

module ğ”˜ where
  open import Groupoids.Ordinary.Construction.Core
  open import Groupoids.Ordinary.Homomorphism
  open import Groupoids.Ordinary.Isomorphism
  open import Groupoids.Ordinary.Monoidal.Exponential
  open import Groupoids.Ordinary.Universe.Boot public

  open â‰…

  Std = ğ”˜ 0 0
  Gpd = ğ”˜ 1 0
  Cat = ğ”˜ 1 1

  Â«seqâ‚€*Â»
    : âˆ€ {r}..{â„“}
    â†’ {A B C : ğ”˜ 1 r â„“}
    â†’ {Fâ‚€ Fâ‚ : Funâ‚€ A B}
    â†’ {Gâ‚€ Gâ‚ : Funâ‚€ B C}
    â†’ A â‡’â‚€ B âŠ¢ Fâ‚€ â‰… Fâ‚
    â†’ B â‡’â‚€ C âŠ¢ Gâ‚€ â‰… Gâ‚
    â†’ A â‡’â‚€ C âŠ¢ â‡’â‚€.seq Fâ‚€ Gâ‚€ â‰… â‡’â‚€.seq Fâ‚ Gâ‚
  apâ‚â‚€ (Â» (Â«seqâ‚€*Â» {C = C}{Fâ‚ = Fâ‚}{Gâ‚€ = Gâ‚€} Î± Î²)) a =
    seqâ‚€ C (apâ‚€â‚ Gâ‚€ (apâ‚â‚€ (Â» Î±) a)) (apâ‚â‚€ (Â» Î²) (apâ‚€â‚€ Fâ‚ a))
  apâ‚â‚ (Â» (Â«seqâ‚€*Â» {C = C}{Fâ‚ = Fâ‚}{Gâ‚€ = Gâ‚€} Î± Î²)) f =
    (seqâ‚ C
      (âŠ¢Î±â‚€ C)
      (seqâ‚ C
        (seqâ‚€*Î» C
          (seqâ‚ C
            (invâ‚ C (â‡’â‚€.âŠ¢seq Gâ‚€))
            (seqâ‚ C
              (apâ‚€â‚‚ Gâ‚€ (apâ‚â‚ (Â» Î±) f))
              (â‡’â‚€.âŠ¢seq Gâ‚€))))
        (seqâ‚ C
          (invâ‚ C (âŠ¢Î±â‚€ C))
          (seqâ‚ C
            (seqâ‚€*Ï C
              (apâ‚â‚ Â»[ Î² ] (apâ‚€â‚ Fâ‚ f)))
            (âŠ¢Î±â‚€ C)))))
  apâ‚â‚€ (Â« (Â«seqâ‚€*Â» {C = C}{Fâ‚€ = Fâ‚€}{Gâ‚ = Gâ‚} Î± Î²)) a =
    seqâ‚€ C (apâ‚€â‚ Gâ‚ (apâ‚â‚€ Â«[ Î± ] a)) (apâ‚â‚€ Â«[ Î² ] (apâ‚€â‚€ Fâ‚€ a))
  apâ‚â‚ (Â« (Â«seqâ‚€*Â» {C = C}{Fâ‚€ = Fâ‚€}{Gâ‚ = Gâ‚} Î± Î²)) f =
    (seqâ‚ C
      (âŠ¢Î±â‚€ C)
      (seqâ‚ C
        (seqâ‚€*Î» C
          (seqâ‚ C
            (invâ‚ C (â‡’â‚€.âŠ¢seq Gâ‚))
            (seqâ‚ C
              (apâ‚€â‚‚ Gâ‚ (apâ‚â‚ Â«[ Î± ] f))
              (â‡’â‚€.âŠ¢seq Gâ‚))))
        (seqâ‚ C
          (invâ‚ C (âŠ¢Î±â‚€ C))
          (seqâ‚ C
            (seqâ‚€*Ï C
              (apâ‚â‚ Â«[ Î² ] (apâ‚€â‚ Fâ‚€ f)))
            (âŠ¢Î±â‚€ C)))))
  âŠ¢Â»Â« (Â«seqâ‚€*Â» {C = C}{Fâ‚€ = Fâ‚€}{Gâ‚ = Gâ‚} Î± Î²) = Î¹ Î» a â†’
    seqâ‚ C
      (seqâ‚€*Î» C
        (apâ‚â‚ Â»[ Î² ] (apâ‚â‚€ Â»[ Î± ] a)))
      (seqâ‚ C
        (invâ‚ C (âŠ¢Î±â‚€ C))
        (seqâ‚ C
          (seqâ‚€*Ï C
            (seqâ‚ C
              (âŠ¢Î±â‚€ C)
              (seqâ‚ C
                (seqâ‚€*Î» C
                  (seqâ‚ C
                    (invâ‚ C (â‡’â‚€.âŠ¢seq Gâ‚))
                    (seqâ‚ C
                      (apâ‚€â‚‚ Gâ‚ (T.âŠ”â‡‘.Ï€ (âŠ¢Â»Â« Î±) a))
                      (â‡’â‚€.âŠ¢idn Gâ‚))))
                (âŠ¢Î»â‚€ C))))
          (T.âŠ”â‡‘.Ï€ (âŠ¢Â»Â« Î²) (apâ‚€â‚€ Fâ‚€ a))))
  âŠ¢Â«Â» (Â«seqâ‚€*Â» {C = C}{Fâ‚ = Fâ‚}{Gâ‚€ = Gâ‚€} Î± Î²) = Î¹ Î» a â†’
    seqâ‚ C
      (seqâ‚€*Î» C
        (apâ‚â‚ Â«[ Î² ] (apâ‚â‚€ Â«[ Î± ] a)))
      (seqâ‚ C
        (invâ‚ C (âŠ¢Î±â‚€ C))
        (seqâ‚ C
          (seqâ‚€*Ï C
            (seqâ‚ C
              (âŠ¢Î±â‚€ C)
              (seqâ‚ C
                (seqâ‚€*Î» C
                  (seqâ‚ C
                    (invâ‚ C (â‡’â‚€.âŠ¢seq Gâ‚€))
                    (seqâ‚ C
                      (apâ‚€â‚‚ Gâ‚€ (T.âŠ”â‡‘.Ï€ (âŠ¢Â«Â» Î±) a))
                      (â‡’â‚€.âŠ¢idn Gâ‚€))))
                (âŠ¢Î»â‚€ C))))
          (T.âŠ”â‡‘.Ï€ (âŠ¢Â«Â» Î²) (apâ‚€â‚€ Fâ‚ a))))

  Â«âŠ¢Î»â‚€Â»
    : âˆ€ {r}..{â„“}
    â†’ {A B : ğ”˜ 1 r â„“}
    â†’ {F : Funâ‚€ A B}
    â†’ A â‡’â‚€ B âŠ¢ â‡’â‚€.seq â‡’â‚€.idn F â‰… F
  apâ‚â‚€ (Â» (Â«âŠ¢Î»â‚€Â» {B = B})) a =
    idnâ‚€ B
  apâ‚â‚ (Â» (Â«âŠ¢Î»â‚€Â» {B = B})) f =
    (seqâ‚ B
      (âŠ¢Ïâ‚€ B)
      (invâ‚ B (âŠ¢Î»â‚€ B)))
  apâ‚â‚€ (Â« (Â«âŠ¢Î»â‚€Â» {B = B})) a =
    idnâ‚€ B
  apâ‚â‚ (Â« (Â«âŠ¢Î»â‚€Â» {B = B})) f =
    (seqâ‚ B
      (âŠ¢Ïâ‚€ B)
      (invâ‚ B (âŠ¢Î»â‚€ B)))
  âŠ¢Â»Â« (Â«âŠ¢Î»â‚€Â» {B = B}) = Î¹ Î» a â†’
    âŠ¢Î»â‚€ B
  âŠ¢Â«Â» (Â«âŠ¢Î»â‚€Â» {B = B}) = Î¹ Î» a â†’
    âŠ¢Î»â‚€ B

  Â«âŠ¢Ïâ‚€Â»
    : âˆ€ {r}..{â„“}
    â†’ {A B : ğ”˜ 1 r â„“}
    â†’ {F : Funâ‚€ A B}
    â†’ A â‡’â‚€ B âŠ¢ â‡’â‚€.seq F â‡’â‚€.idn â‰… F
  apâ‚â‚€ (Â» (Â«âŠ¢Ïâ‚€Â» {B = B})) a =
    idnâ‚€ B
  apâ‚â‚ (Â» (Â«âŠ¢Ïâ‚€Â» {B = B})) f =
    (seqâ‚ B
      (âŠ¢Ïâ‚€ B)
      (invâ‚ B (âŠ¢Î»â‚€ B)))
  apâ‚â‚€ (Â« (Â«âŠ¢Ïâ‚€Â» {B = B})) a =
    idnâ‚€ B
  apâ‚â‚ (Â« (Â«âŠ¢Ïâ‚€Â» {B = B})) f =
    (seqâ‚ B
      (âŠ¢Ïâ‚€ B)
      (invâ‚ B (âŠ¢Î»â‚€ B)))
  âŠ¢Â»Â« (Â«âŠ¢Ïâ‚€Â» {B = B}) = Î¹ Î» a â†’
    âŠ¢Î»â‚€ B
  âŠ¢Â«Â» (Â«âŠ¢Ïâ‚€Â» {B = B}) = Î¹ Î» a â†’
    âŠ¢Î»â‚€ B

  Â«âŠ¢Î±â‚€Â»
    : âˆ€ {r}..{â„“}
    â†’ {A B C D : ğ”˜ 1 r â„“}
    â†’ {F : Funâ‚€ A B}
    â†’ {G : Funâ‚€ B C}
    â†’ {H : Funâ‚€ C D}
    â†’ A â‡’â‚€ D âŠ¢ â‡’â‚€.seq F (â‡’â‚€.seq G H) â‰… â‡’â‚€.seq (â‡’â‚€.seq F G) H
  apâ‚â‚€ (Â» (Â«âŠ¢Î±â‚€Â» {D = D})) a =
    idnâ‚€ D
  apâ‚â‚ (Â» (Â«âŠ¢Î±â‚€Â» {D = D})) {a}{b} f =
    seqâ‚ D
      (âŠ¢Ïâ‚€ D)
      (invâ‚ D (âŠ¢Î»â‚€ D))
  apâ‚â‚€ (Â« (Â«âŠ¢Î±â‚€Â» {D = D})) a =
    idnâ‚€ D
  apâ‚â‚ (Â« (Â«âŠ¢Î±â‚€Â» {D = D})) {a}{b} f =
    seqâ‚ D
      (âŠ¢Ïâ‚€ D)
      (invâ‚ D (âŠ¢Î»â‚€ D))
  âŠ¢Â»Â« (Â«âŠ¢Î±â‚€Â» {D = D}) = Î¹ Î» a â†’
    âŠ¢Î»â‚€ D
  âŠ¢Â«Â» (Â«âŠ¢Î±â‚€Â» {D = D}) = Î¹ Î» a â†’
    âŠ¢Î»â‚€ D

  Â«CatÂ»
    : âˆ€ r ..â„“
    â†’ ğ”˜ 2 1 _
  â— [ Â«CatÂ» r â„“ ] = ğ”˜ 1 r â„“
  â‡‡ [ Â«CatÂ» r â„“ ] A B = [ A â‡”â‚€ B ]
  â†» [ Â«CatÂ» r â„“ ] = â‡’â‚€.idn
  seqâ‚€ (Â«CatÂ» r â„“) = â‡’â‚€.seq
  invâ‚€ (Â«CatÂ» r â„“) F {â‰œ = ()}
  seqâ‚€* (Â«CatÂ» r â„“) = Â«seqâ‚€*Â»
  invâ‚€* (Â«CatÂ» r â„“) Î± {â‰œ = ()}
  âŠ¢Î»â‚€ (Â«CatÂ» r â„“) = Â«âŠ¢Î»â‚€Â»
  âŠ¢Ïâ‚€ (Â«CatÂ» r â„“) = Â«âŠ¢Ïâ‚€Â»
  âŠ¢Î±â‚€ (Â«CatÂ» r â„“) = Â«âŠ¢Î±â‚€Â»
  âŠ¢Î»â‚€â»Â¹ (Â«CatÂ» r â„“) {â‰œ = ()}
  âŠ¢Ïâ‚€â»Â¹ (Â«CatÂ» r â„“) {â‰œ = ()}
  idnâ‚ (Â«CatÂ» r â„“) {A}{B} = â‰….idn (A â‡’â‚€ B)
  seqâ‚ (Â«CatÂ» r â„“) {A}{B} = â‰….seq (A â‡’â‚€ B)
  invâ‚ (Â«CatÂ» r â„“) {A}{B} = â‰….inv (A â‡’â‚€ B)

  Â«GpdÂ»
    : âˆ€ r ..â„“
    â†’ ğ”˜ 2 0 _
  Â«GpdÂ» r â„“ = [ Â«CatÂ» r â„“ ]/â‰…

open ğ”˜ public
